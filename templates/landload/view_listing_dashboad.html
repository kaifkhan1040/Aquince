{% extends 'landload/basic.html' %} 
{% load static %}
{% block style %}


    <!-- BEGIN: Vendor CSS-->
     {% comment %} <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/tables/datatable/jquery.dataTables.min.css' %}"> {% endcomment %}
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/forms/select/select2.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/tables/datatable/dataTables.bootstrap5.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/tables/datatable/responsive.bootstrap5.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/tables/datatable/buttons.bootstrap5.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/tables/datatable/rowGroup.bootstrap5.min.css' %}">
    <!-- END: Vendor CSS-->
    {% comment %} <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/core/menu/menu-types/vertical-menu.css' %}"> {% endcomment %}
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/plugins/forms/form-validation.css' %}">
    <!-- END: Page CSS-->

    <!-- BEGIN: Custom CSS-->
    {% comment %} <link rel="stylesheet" type="text/css" href="{% static 'assets/css/style.css' %}"> {% endcomment %}
    <!-- END: Custom CSS-->


{% endblock style %}
{% block content %}


    <!-- BEGIN: Content-->
        <div class="container-xxl flex-grow-1 container-p-y">
          <div class="d-flex justify-content-between align-items-center mb-3">
  
            <nav aria-label="breadcrumb">
              <ol class="breadcrumb mb-0">
                <li class="breadcrumb-item"><a href="{% url 'landload:home' %}">Home</a></li>
                <li class="breadcrumb-item " aria-current="page"><a href="{% url 'landload:listing' %}">Listings</a></li>
                <li class="breadcrumb-item active">Dashboard</li>
              </ol>
            </nav>
          </div>
             
                <!-- users list start -->
               
                <div class="row g-6">
                    <!-- list and filter start -->
                    <div class="card">
                        
                        <div class="card-body border-bottom">
                            <div class="row">
                                <div class="col-md-4 ">
                                    Listing id - {{property_obj.custom_id}}
                                    {% comment %} <a href="{% url 'landload:listing_add' %}"><button class="btn btn-primary w-80 waves-effect waves-float waves-light" >Add Listing</button></a> {% endcomment %}
                                </div>
                                <div class="col-md-6">

                                </div>
                                <div class="col-md-2 ">
                                   {% comment %} <div class="demo-inline-spacing"> {% endcomment %}
                                        <div class="btn-group">
                                            <button type="button" class="btn btn-outline-success dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                            More
                                            </button>
                                            <ul class="dropdown-menu">
                                            
                                            <li><a class="dropdown-item" href="{% url 'landload:listing_view' id=property_obj.custom_id %}">Details</a></li>
                                            <li><a class="dropdown-item" href="javascript:void(0);">Tenants</a></li>
                                            {% if property_obj.number_of_flat %}
                                            <li><a class="dropdown-item" href="{% url 'landload:room' id=property_id %}">Rooms</a></li>
                                            {% endif %}
                                            <li><a class="dropdown-item" href="javascript:void(0);">Tickets</a></li>
                                            <li><a class="dropdown-item" href="javascript:void(0);">Tasks</a></li>
                                            <li><a class="dropdown-item" href="javascript:void(0);">Logs</a></li>
                                            <li><a class="dropdown-item" href="javascript:void(0);">Notes</a></li>
                                            <li><a class="dropdown-item" href="javascript:void(0);">Dues</a></li>
                                            
                                            
                                            </ul>
                                        </div>
                                    {% comment %} </div> {% endcomment %}
                                </div>
                            </div>
                        </div>
                        
                        
                        
                    </div>
                    <!-- list and filter end -->
               
                
                   <!-- Generated Leads -->
                    <div class="col-xl-4">
                      <div class="card h-100">
                        <div class="card-body d-flex justify-content-between">
                          <div class="d-flex flex-column">
                            <div class="card-title mb-auto">
                              <h5 class="mb-0 text-nowrap">Occupied vs Advertised </h5>
                              <p class="mb-0">Monthly Report</p>
                            </div>
                            <div class="chart-statistics">
                              {% comment %} <h3 class="card-title mb-0">4,350</h3> {% endcomment %}
                              <p class="text-success text-nowrap mb-0">
                                {% comment %} <i class="icon-base ti tabler-chevron-up me-1"></i> 15.8% {% endcomment %}
                              </p>
                            </div>
                          </div>
                          <div id="generatedLeadsChart"></div>
                        </div>
                      </div>
                    </div>
                    <div class="col-lg-3 col-sm-6">
                    <div class="card card-border-shadow-warning h-100">
                      <div class="card-body">
                        <div class="d-flex align-items-center mb-2">
                          <div class="avatar me-4">
                            <span class="avatar-initial rounded bg-label-warning"
                              ><i class="icon-base ti tabler-alert-triangle icon-28px"></i
                            ></span>
                          </div>
                          <h4 class="mb-0">DUES</h4>
                        </div>
                        
                        <div class=" d-flex justify-content-between">
                              <span class="text-heading fw-medium">Total Dues</span>
                              <small class="text-body-secondary">{{symbol|safe}} 00</small>
                          </div>

                          <div class=" d-flex justify-content-between">
                              <span class="text-heading fw-medium">Longest</span>
                              <small class="text-body-secondary">pending</small>
                          </div>

                          <div class=" d-flex justify-content-between">
                              <span class="text-heading fw-medium">Highest</span>
                              <small class="text-body-secondary">pending</small>
                          </div>

                        
                      </div>
                    </div>
                </div>
                {% comment %} <div class="col-lg-3 col-sm-6">
                  <div class="card card-border-shadow-danger h-100">
                    <div class="card-body">
                      <div class="d-flex align-items-center mb-2">
                        <div class="avatar me-4">
                          <span class="avatar-initial rounded bg-label-danger"
                            ><i class="icon-base ti tabler-git-fork icon-28px"></i
                          ></span>
                        </div>
                        <h4 class="mb-0">LISTINGS</h4>
                      </div>
                      
                       <div class=" d-flex justify-content-between">
                            <span class="text-heading fw-medium">Total Listed</span>
                            <small class="text-body-secondary">{{listing}}</small>
                        </div>

                        <div class=" d-flex justify-content-between">
                            <span class="text-heading fw-medium">Occupied</span>
                            <small class="text-body-secondary">{{occupied}}</small>
                        </div>

                        <div class=" d-flex justify-content-between">
                            <span class="text-heading fw-medium">Empty</span>
                            <small class="text-body-secondary">{{empty}}</small>
                        </div>
                    </div>
                  </div>
                </div> {% endcomment %}
                <div class="col-lg-3 col-sm-6">
                  <div class="card card-border-shadow-info h-100">
                    <div class="card-body">
                      <div class="d-flex align-items-center mb-2">
                        <div class="avatar me-4">
                          <span class="avatar-initial rounded bg-label-info"
                            ><i class="icon-base ti tabler-clock icon-28px"></i
                          ></span>
                        </div>
                        <h4 class="mb-0 ">Tickets</h4>
                      </div>
                      <div class=" d-flex justify-content-between">
                            <span class="text-heading fw-medium">Total Tickets</span>
                            <small class="text-body-secondary">00</small>
                        </div>

                        <div class=" d-flex justify-content-between">
                            <span class="text-heading fw-medium">In Progress</span>
                            <small class="text-body-secondary">00</small>
                        </div>

                        <div class=" d-flex justify-content-between">
                            <span class="text-heading fw-medium">Resolved</span>
                            <small class="text-body-secondary">00</small>
                        </div>
                        <div class=" d-flex justify-content-between">
                            <span class="text-heading fw-medium">Longest Open</span>
                            <small class="text-body-secondary">00</small>
                        </div>
                    </div>
                  </div>
                </div>
                    <!--/ Generated Leads -->
                    <div class="col-xxl-8 col-12">
                  <div class="card h-100">
                    <div class="card-header d-flex justify-content-between">
                      <div class="card-title m-0">
                        <h5 class="mb-1">Earning Reports</h5>
                        <p class="card-subtitle">Yearly Earnings Overview</p>
                      </div>
                    <div>
                      <select name="year" id="year_id" class="form-select form-select-sm" required>
                        <option value="">Select Year</option>
                        <option value="2025">2025</option>
                        <option value="2026">2026</option>
                        <option value="2027">2027</option>
                        <option value="2028">2028</option>
                      </select>
                    </div>
                  
                    </div>
                    <div class="card-body">
                      <ul class="nav nav-tabs widget-nav-tabs pb-8 gap-4 mx-1 d-flex flex-nowrap" role="tablist">
                        <li class="nav-item">
                          <a
                            href="javascript:void(0);"
                            class="nav-link btn active d-flex flex-column align-items-center justify-content-center"
                            role="tab"
                            data-bs-toggle="tab"
                            data-bs-target="#navs-orders-id"
                            aria-controls="navs-orders-id"
                            aria-selected="true">
                            <div class="badge bg-label-secondary rounded p-2">
                              <i class="icon-base ti tabler-shopping-cart icon-md"></i>
                            </div>
                            <h6 class="tab-widget-title mb-0 mt-2">Profit</h6>
                          </a>
                        </li>
                        <li class="nav-item">
                          <a
                            href="javascript:void(0);"
                            class="nav-link btn d-flex flex-column align-items-center justify-content-center"
                            role="tab"
                            data-bs-toggle="tab"
                            data-bs-target="#navs-sales-id"
                            aria-controls="navs-sales-id"
                            aria-selected="false">
                            <div class="badge bg-label-secondary rounded p-2">
                              <i class="icon-base ti tabler-chart-bar-popular icon-md"></i>
                            </div>
                            <h6 class="tab-widget-title mb-0 mt-2">Loss</h6>
                          </a>
                        </li>
                        <li class="nav-item">
                          <a
                            href="javascript:void(0);"
                            class="nav-link btn d-flex flex-column align-items-center justify-content-center"
                            role="tab"
                            data-bs-toggle="tab"
                            data-bs-target="#navs-profit-id"
                            aria-controls="navs-profit-id"
                            aria-selected="false">
                            <div class="badge bg-label-secondary rounded p-2">
                              <i class="icon-base ti tabler-currency-dollar icon-md"></i>
                            </div>
                            <h6 class="tab-widget-title mb-0 mt-2">Spend vs<br> Earned</h6>
                          </a>
                        </li>
                        <li class="nav-item">
                          <a
                            href="javascript:void(0);"
                            class="nav-link btn d-flex flex-column align-items-center justify-content-center"
                            role="tab"
                            data-bs-toggle="tab"
                            data-bs-target="#navs-income-id"
                            aria-controls="navs-income-id"
                            aria-selected="false">
                            <div class="badge bg-label-secondary rounded p-2">
                              <i class="icon-base ti tabler-chart-pie-2 icon-md"></i>
                            </div>
                            <h6 class="tab-widget-title mb-0 mt-2">Maintenance</h6>
                          </a>
                        </li>
                        <li class="nav-item">
                          <a
                            href="javascript:void(0);"
                            class="nav-link btn d-flex align-items-center justify-content-center flex-column "
                            role="tab"
                            data-bs-toggle="tab"
                            aria-selected="false">
                            <div class="badge bg-label-secondary rounded p-2">
                               <i class="icon-base ti tabler-file-invoice icon-md"></i>
                            </div>
                            <h6 class="tab-widget-title mb-0 mt-2">Bills</h6>
                          </a>
                        </li>
                      </ul>
                      <div class="tab-content p-0 ms-0 ms-sm-2">
                        <div class="tab-pane fade show active" id="navs-orders-id" role="tabpanel">
                          <div id="earningReportsTabsOrders"></div>
                        </div>
                        <div class="tab-pane fade" id="navs-sales-id" role="tabpanel">
                          <div id="earningReportsTabsSales"></div>
                        </div>
                        <div class="tab-pane fade" id="navs-profit-id" role="tabpanel">
                          <div id="earningReportsTabsProfit"></div>
                        </div>
                        <div class="tab-pane fade" id="navs-income-id" role="tabpanel">
                          <div id="earningReportsTabsIncome"></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-xxl-12">
                  <div class="card h-100">
                    <div class="card-body p-0">
                      <div class="row row-bordered g-0">
                        <div class="col-md-8 position-relative p-6">
                          <div class="card-header d-inline-block p-0 text-wrap position-absolute">
                            <h5 class="m-0 card-title">Revenue Report</h5>
                          </div>
                          <div id="totalRevenueChart" class="mt-n1"></div>
                        </div>
                      
                          
                      </div>
                    </div>
                  </div>
                </div>
                
                {% comment %} profit by property {% endcomment %}

                 <div class="col-xxl-4 col-md-6 order-1 order-xl-0">
                  <div class="card h-100">
                    <div class="card-header d-flex justify-content-between">
                      <div class="card-title mb-0">
                        <h5 class="mb-1">Profit by Properties</h5>
                        <p class="card-subtitle">Monthly profit Overview</p>
                      </div>
                      <div class="dropdown">
                        {% comment %} <button
                          class="btn btn-text-secondary btn-icon rounded-pill text-body-secondary border-0 me-n1"
                          type="button"
                          id="salesByCountry"
                          data-bs-toggle="dropdown"
                          aria-haspopup="true"
                          aria-expanded="false">
                          <i class="icon-base ti tabler-dots-vertical icon-22px text-body-secondary"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="salesByCountry">
                          <a class="dropdown-item" href="javascript:void(0);">Download</a>
                          <a class="dropdown-item" href="javascript:void(0);">Refresh</a>
                          <a class="dropdown-item" href="javascript:void(0);">Share</a>
                        </div> {% endcomment %}
                      </div>
                    </div>
                    <div class="card-body">
                      <ul class="p-0 m-0" style="max-height: 400px; overflow-y: auto;">
                        {% for i in profit_by_property %}
                        <li class="d-flex align-items-center mb-4">
                          <div class="avatar flex-shrink-0 me-4">
                            <i class="fis fi fi-us rounded-circle fs-2"></i>
                          </div>
                          <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                            <div class="me-2">
                              <div class="d-flex align-items-center">
                                <h6 class="mb-0 me-1">{{symbol|safe}} {{i.this_month_profit}}</h6>
                              </div>
                              <small class="text-body">{{i.property_name}}</small>
                            </div>
                            {% if i.change_status == 'increase' %}
                            <div class="user-progress">
                              <p class="text-success fw-medium mb-0 d-flex align-items-center gap-1">
                                <i class="icon-base ti tabler-chevron-up"></i>
                                {{i.percent_change}}%
                              </p>
                            </div>
                            {% else %}
                             <div class="user-progress">
                              <p class="text-danger fw-medium mb-0 d-flex align-items-center gap-1">
                                <i class="icon-base ti tabler-chevron-down"></i>
                                {{i.percent_change}}%
                              </p>
                            </div>
                            {% endif %}
                          </div>
                        </li>
                     {% endfor %}
                      </ul>
                    </div>
                  </div>
                </div>
                {% comment %} profit by property {% endcomment %}

                <div class="col-xxl-4 col-md-6 order-1 order-xl-0">
                  <div class="card h-100">
                    <div class="card-header d-flex justify-content-between">
                      <div class="card-title mb-0">
                        <h5 class="mb-1">Loss by Properties</h5>
                        <p class="card-subtitle">Monthly Loss Overview</p>
                      </div>
                      <div class="dropdown">
                        {% comment %} <button
                          class="btn btn-text-secondary btn-icon rounded-pill text-body-secondary border-0 me-n1"
                          type="button"
                          id="salesByCountry"
                          data-bs-toggle="dropdown"
                          aria-haspopup="true"
                          aria-expanded="false">
                          <i class="icon-base ti tabler-dots-vertical icon-22px text-body-secondary"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="salesByCountry">
                          <a class="dropdown-item" href="javascript:void(0);">Download</a>
                          <a class="dropdown-item" href="javascript:void(0);">Refresh</a>
                          <a class="dropdown-item" href="javascript:void(0);">Share</a>
                        </div> {% endcomment %}
                      </div>
                    </div>
                    <div class="card-body">
                      <ul class="p-0 m-0" style="max-height: 400px; overflow-y: auto;">
                        {% for i in loss_by_property %}
                        <li class="d-flex align-items-center mb-4">
                          <div class="avatar flex-shrink-0 me-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="fs-2 rounded-circle" width="40" height="40" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                              <path d="M5 12l-2 0l9 -9l9 9l-2 0" />
                              <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
                              <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
                            </svg>
                          </div>

                          <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                            <div class="me-2">
                              <div class="d-flex align-items-center">
                                <h6 class="mb-0 me-1">{{symbol|safe}} {{i.this_month_profit}}</h6>
                              </div>
                              <small class="text-body">{{i.property_name}}</small>
                            </div>
                            {% if i.change_status == 'loss-to-profit' %}
                            <div class="user-progress">
                              <p class="text-success fw-medium mb-0 d-flex align-items-center gap-1">
                                <i class="icon-base ti tabler-chevron-up"></i>
                                {{i.percent_change}}%
                              </p>
                            </div>
                            {% else %}
                             <div class="user-progress">
                              <p class="text-danger fw-medium mb-0 d-flex align-items-center gap-1">
                                <i class="icon-base ti tabler-chevron-down"></i>
                                {{i.percent_change}}%
                              </p>
                            </div>
                            {% endif %}
                          </div>
                        </li>
                     {% endfor %}
                      </ul>
                    </div>
                  </div>
                </div>
                {% comment %} loss by property {% endcomment %}


                <!-- Last payment -->
                <div class="col-md-6 col-12">
                  <div class="card h-100">
                    <div class="card-header d-flex justify-content-between align-items-center">
                      <h5 class="card-title m-0 me-2">Payments</h5>
                      <div class="dropdown">
                        {% comment %} <button
                          class="btn btn-text-secondary rounded-pill text-body-secondary border-0 p-2 me-n1"
                          type="button"
                          id="teamMemberList"
                          data-bs-toggle="dropdown"
                          aria-haspopup="true"
                          aria-expanded="false">
                          <i class="icon-base ti tabler-dots-vertical icon-md text-body-secondary"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="teamMemberList">
                          <a class="dropdown-item" href="javascript:void(0);">Download</a>
                          <a class="dropdown-item" href="javascript:void(0);">Refresh</a>
                          <a class="dropdown-item" href="javascript:void(0);">Share</a>
                        </div> {% endcomment %}
                      </div>
                    </div>
                    <div class="table-responsive">
                      <table class="table table-borderless border-top">
                        <thead class="border-bottom">
                          <tr>
                            <th>Date</th>
                            <th>By</th>
                            <th>For</th>
                            <th>Mode</th>
                            <th>Status</th>
                            <th>Amount</th>
                          </tr>
                        </thead>
                        <tbody>
                          {% if payment %}
                          {% for i in payment %}
                          <tr>
                            <td class="pt-5">
                              <small class="text-body text-nowrap">{{i.paid_date|safe}}</small>
                              
                            </td>
                            <td class="pt-5">
                              <div class="d-flex flex-column">
                                <p class="mb-0 text-heading">{{i.tenant_name}}</p>
                                
                              </div>
                            </td>
                            <td class="pt-5"><p class="mb-0 text-heading">{{i.m_for}}</p></td>
                            <td class="pt-5"><p class="mb-0 text-heading">{{i.method}}</p></td>
                            <td class="pt-5"><span class="badge bg-label-success">Verified</span></td>
                            <td class="pt-5">
                              <p class="mb-0 text-heading">{{symbol|safe}} {{i.amount}}</p>
                            </td>
                          </tr>
                         {% endfor %}
                         {% else %}
                         <tr>
                              <td colspan="6" class="text-center pt-5">
                                  <p class="mb-0 text-muted">No payments available</p>
                              </td>
                          </tr>
                            {% endif %}
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
                <!--/ Last payment -->
                <!-- Last Expenses -->
                <div class="col-md-6 col-12">
                  <div class="card h-100">
                    <div class="card-header d-flex justify-content-between align-items-center">
                      <h5 class="card-title m-0 me-2">Expenses</h5>
                      <div class="dropdown">
                        {% comment %} <button
                          class="btn btn-text-secondary rounded-pill text-body-secondary border-0 p-2 me-n1"
                          type="button"
                          id="teamMemberList"
                          data-bs-toggle="dropdown"
                          aria-haspopup="true"
                          aria-expanded="false">
                          <i class="icon-base ti tabler-dots-vertical icon-md text-body-secondary"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="teamMemberList">
                          <a class="dropdown-item" href="javascript:void(0);">Download</a>
                          <a class="dropdown-item" href="javascript:void(0);">Refresh</a>
                          <a class="dropdown-item" href="javascript:void(0);">Share</a>
                        </div> {% endcomment %}
                      </div>
                    </div>
                   <div class="table-responsive">
                      <table class="table table-borderless border-top">
                        <thead class="border-bottom">
                          <tr>
                            <th>Date</th>
                            <th>By</th>
                            <th>For</th>
                            <th>Mode</th>
                            <th>Status</th>
                            <th>Amount</th>
                          </tr>
                        </thead>
                        <tbody>
                          {% if expense %}
                          {% for i in expense %}
                          <tr>
                            <td class="pt-5">
                              <small class="text-body text-nowrap">{{i.paid_date|safe}}</small>
                              
                            </td>
                            <td class="pt-5">
                              <div class="d-flex flex-column">
                                <p class="mb-0 text-heading">{{i.tenant_name}}</p>
                                
                              </div>
                            </td>
                            <td class="pt-5"><p class="mb-0 text-heading">{{i.m_for}}</p></td>
                            <td class="pt-5"><p class="mb-0 text-heading">{{i.method}}</p></td>
                            <td class="pt-5"><span class="badge bg-label-success">Verified</span></td>
                            <td class="pt-5">
                              <p class="mb-0 text-heading">{{symbol|safe}} {{i.amount}}</p>
                            </td>
                          </tr>
                         {% endfor %}
                          
                         {% else %}
                         <tr>
                              <td colspan="6" class="text-center pt-5">
                                  <p class="mb-0 text-muted">No expense available</p>
                              </td>
                          </tr>
                            {% endif %}
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
                
                
                </div>
                <!-- users list ends -->

           
        </div>
{% endblock content %}
{% block scriptjs %}




    <!-- BEGIN: Page Vendor JS-->
    <script src="{% static 'app-assets/vendors/js/forms/select/select2.full.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/jquery.dataTables.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/dataTables.bootstrap5.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/dataTables.responsive.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/responsive.bootstrap5.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/datatables.checkboxes.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/datatables.buttons.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/jszip.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/pdfmake.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/vfs_fonts.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/buttons.html5.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/buttons.print.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/dataTables.rowGroup.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/forms/validation/jquery.validate.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/forms/cleave/cleave.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/forms/cleave/addons/cleave-phone.us.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/pickers/flatpickr/flatpickr.min.js' %}"></script>
<script src="{% static 'app-assets/js/scripts/components/components-dropdowns.js' %}"></script>
    {% comment %} <script src="{% static 'v2/assets/js/app-ecommerce-dashboard.js' %}"></script> {% endcomment %}

    
    {% comment %} <script src="{% static 'app-assets/js/scripts/tables/listing-datatables.js' %}"></script> {% endcomment %}
    <!-- END: Page Vendor JS-->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- BEGIN: Theme JS-->
    <!-- <script src="{% static 'app-assets/js/core/app-menu.js' %}"></script>
    <script src="{% static 'app-assets/js/core/app.js' %}"></script> -->
    <!-- END: Theme JS-->

    <!-- BEGIN: Page JS-->
    <!-- <script src="{% static 'app-assets/js/scripts/pages/app-user-list.js' %}"></script> -->
    <!-- END: Page JS-->

<!-- END: Body-->
<!-- <script>
  document.getElementById('searchbtn001').addEventListener('click', function() {
      document.getElementById('search001').submit();
  });
</script> -->
  <script>

     
  // Pass Django context variables into JS
  const chartData = JSON.parse('{{ chart_data|safe|escapejs }}');
  (function () {
  let cardColor, labelColor, fontFamily, headingColor, shadeColor, legendColor, borderColor, barBgColor;
  if (isDarkStyle) {
    barBgColor = '#3d4157';
    shadeColor = 'dark';
  } else {
    barBgColor = '#efeef0';
    shadeColor = '';
  }
  cardColor = config.colors.cardColor;
  labelColor = config.colors.textMuted;
  legendColor = config.colors.bodyColor;
  borderColor = config.colors.borderColor;
  headingColor = config.colors.headingColor;
  function EarningReportsBarChart(arrayData, highlightData) {
    const basicColor = config.colors_label.primary,
      highlightColor = config.colors.primary;
    var colorArr = [];
    let maxValue = Math.max(...arrayData);

    for (let i = 0; i < arrayData.length; i++) {
      if (i === highlightData) {
        colorArr.push(highlightColor);
      } else {
        colorArr.push(basicColor);
      }
    }

    const earningReportBarChartOpt = {
      chart: {
        height: 231,
        parentHeightOffset: 0,
        type: 'bar',
        toolbar: {
          show: false
        }
      },
      plotOptions: {
        bar: {
          columnWidth: '32%',
          startingShape: 'rounded',
          borderRadius: 6,
          distributed: true,
          dataLabels: {
            position: 'top'
          }
        }
      },
      grid: {
        show: false,
        padding: {
          top: 0,
          bottom: 0,
          left: -10,
          right: -10
        }
      },
      colors: colorArr,
      dataLabels: {
        enabled: true,
        formatter: function (val) {
          return val + 'k';
        },
        offsetY: -30,
        style: {
          fontSize: '15px',
          colors: [headingColor],
          fontWeight: '500',
          fontFamily: fontFamily
        }
      },
      series: [
        {
          data: arrayData
        }
      ],
      legend: {
        show: false
      },
      tooltip: {
        enabled: false
      },
      xaxis: {
        categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep','OCT','NOV','Dec'],
        axisBorder: {
          show: true,
          color: borderColor
        },
        axisTicks: {
          show: false
        },
        labels: {
          style: {
            colors: labelColor,
            fontSize: '13px',
            fontFamily: fontFamily
          }
        }
      },
      yaxis: {
        labels: {
          offsetX: -15,
          formatter: function (val) {
            return parseInt(val / 1) + 'k';
          },
          style: {
            fontSize: '13px',
            colors: labelColor,
            fontFamily: fontFamily
          },
          min: 0,
          max: maxValue,
          tickAmount: 6
        }
      },
      responsive: [
        {
          breakpoint: 1441,
          options: {
            plotOptions: {
              bar: {
                columnWidth: '41%'
              }
            }
          }
        },
        {
          breakpoint: 590,
          options: {
            plotOptions: {
              bar: {
                columnWidth: '61%',
                borderRadius: 5
              }
            },
            yaxis: {
              labels: {
                show: false
              }
            },
            grid: {
              padding: {
                right: 0,
                left: -20
              }
            },
            dataLabels: {
              style: {
                fontSize: '12px',
                fontWeight: '400'
              }
            }
          }
        }
      ]
    };
    return earningReportBarChartOpt;
  }
  var chartJson = 'earning-reports-charts.json';
  // Earning Chart JSON data
  function loadChart(year) {
  var earningReportsChart = $.ajax({
    //url: assetsPath + 'json/' + chartJson, //? Use your own search api instead
    url: "{% url 'landload:property_earning_report' year=0 pro_id=property_obj.id %}".replace("0", year,"1"),
    dataType: 'json',
    async: false
  }).responseJSON;
  console.log('ear',earningReportsChart)
  var vsmaxValue = Math.max(...earningReportsChart['earning'][0]['chart_data']);
  var vsminValue = Math.min(...earningReportsChart['expenses'][0]['chart_data']);

  // Earning Reports Tabs Orders
  // --------------------------------------------------------------------
  const earningReportsTabsOrdersEl = document.querySelector('#earningReportsTabsOrders'),
    earningReportsTabsOrdersConfig = EarningReportsBarChart(
      earningReportsChart['data'][0]['chart_data'],
      earningReportsChart['data'][0]['active_option']
    );
 
    
     if (earningReportsTabsOrdersEl) {
    if (earningReportsTabsOrders instanceof ApexCharts) {
      earningReportsTabsOrders.destroy(); // ✅ will work because it's a real chart instance
    }
    earningReportsTabsOrders = new ApexCharts(earningReportsTabsOrdersEl, earningReportsTabsOrdersConfig);
    earningReportsTabsOrders.render();
  }
  
  // Earning Reports Tabs Sales
  // --------------------------------------------------------------------
  {% comment %} const earningReportsTabsSalesEl = document.querySelector('#earningReportsTabsSales'),
    earningReportsTabsSalesConfig = EarningReportsBarChart(
      earningReportsChart['data'][1]['chart_data'],
      earningReportsChart['data'][1]['active_option']
    );
  if (typeof earningReportsTabsSalesEl !== undefined && earningReportsTabsSalesEl !== null) {
    const earningReportsTabsSales = new ApexCharts(earningReportsTabsSalesEl, earningReportsTabsSalesConfig);
    earningReportsTabsSales.render();
  } {% endcomment %}
  // Earning Reports Tabs Profit
  // --------------------------------------------------------------------
  const earningReportsTabsProfitEl = document.querySelector('#earningReportsTabsProfit'),
    totalRevenueChartOptions = {
      series: [
        {
          name: 'Earning',
          data: earningReportsChart['earning'][0]['chart_data'],
        },
        {
          name: 'Expense',
          data: earningReportsChart['expenses'][0]['chart_data'],
        }
      ],
      chart: {
        height: 231,
        parentHeightOffset: 0,
        stacked: true,
        type: 'bar',
        toolbar: { show: false }
      },
      tooltip: {
        enabled: false
      },
      plotOptions: {
        bar: {
          horizontal: false,
          columnWidth: '40%',
          borderRadius: 7,
          startingShape: 'rounded',
          endingShape: 'rounded',
          borderRadiusApplication: 'around',
          borderRadiusWhenStacked: 'last'
        }
      },
      colors: [config.colors.primary, config.colors.warning],
      dataLabels: {
        enabled: false
      },
      stroke: {
        curve: 'smooth',
        width: 6,
        lineCap: 'round',
        colors: [cardColor]
      },
      legend: {
        show: true,
        horizontalAlign: 'right',
        position: 'top',
        fontSize: '13px',
        fontFamily: fontFamily,
        markers: {
          size: 6,
          offsetY: 0,
          shape: 'circle',
          strokeWidth: 0
        },
        labels: {
          colors: headingColor
        },
        itemMargin: {
          horizontal: 10,
          vertical: 2
        }
      },
      grid: {
        show: false,
        padding: {
          bottom: -8,
          right: 0,
          top: 20
        }
      },
      xaxis: {
        categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep','Oct','Nov','Dec'],
        labels: {
          style: {
            fontSize: '13px',
            colors: labelColor,
            fontFamily: fontFamily
          }
        },
        axisTicks: {
          show: false
        },
        axisBorder: {
          show: false
        }
      },
      yaxis: {
        labels: {
          offsetX: -16,
          style: {
            fontSize: '13px',
            colors: labelColor,
            fontFamily: fontFamily
          }
        },
        min: vsminValue,
        max: vsmaxValue,
        tickAmount: 5
      },
      responsive: [
        {
          breakpoint: 1700,
          options: {
            plotOptions: {
              bar: {
                columnWidth: '43%'
              }
            }
          }
        },
        {
          breakpoint: 1441,
          options: {
            plotOptions: {
              bar: {
                columnWidth: '50%'
              }
            }
          }
        },
        {
          breakpoint: 1300,
          options: {
            plotOptions: {
              bar: {
                columnWidth: '40%'
              }
            }
          }
        },
        {
          breakpoint: 991,
          options: {
            plotOptions: {
              bar: {
                columnWidth: '38%'
              }
            }
          }
        },
        {
          breakpoint: 850,
          options: {
            plotOptions: {
              bar: {
                columnWidth: '50%'
              }
            }
          }
        },
        {
          breakpoint: 449,
          options: {
            plotOptions: {
              bar: {
                columnWidth: '73%'
              }
            },
            xaxis: {
              labels: {
                offsetY: -5
              }
            },
            legend: {
              show: true,
              horizontalAlign: 'right',
              position: 'top',
              itemMargin: {
                horizontal: 10,
                vertical: 0
              }
            }
          }
        },
        {
          breakpoint: 394,
          options: {
            plotOptions: {
              bar: {
                columnWidth: '88%'
              }
            },
            legend: {
              show: true,
              horizontalAlign: 'center',
              position: 'bottom',
              markers: {
                offsetX: -3,
                offsetY: 0
              },
              itemMargin: {
                horizontal: 10,
                vertical: 5
              }
            }
          }
        }
      ],
      states: {
        hover: {
          filter: {
            type: 'none'
          }
        },
        active: {
          filter: {
            type: 'none'
          }
        }
      }
    };
  if (typeof earningReportsTabsProfitEl !== undefined && earningReportsTabsProfitEl !== null) {
    if (earningReportsTabsProfit instanceof ApexCharts) {
      earningReportsTabsProfit.destroy(); // ✅ will work because it's a real chart instance
    }
    earningReportsTabsProfit = new ApexCharts(earningReportsTabsProfitEl, totalRevenueChartOptions);
    earningReportsTabsProfit.render();


  }}
   loadChart(new Date().getFullYear());

  // On year change
  $(document).on("change", "#year_id", function () {
    let year = $(this).val();
    if (year) {
      loadChart(year);
    }
  });
  })();
  // Earning Reports Tabs Income
  // --------------------------------------------------------------------

  let cardColor, labelColor, headingColor, borderColor, legendColor, fontFamily;

  cardColor = config.colors.cardColor;
  labelColor = config.colors.textMuted;
  legendColor = config.colors.bodyColor;
  headingColor = config.colors.headingColor;
  borderColor = config.colors.borderColor;
  fontFamily = config.fontFamily;

  // Donut Chart Colors
  const chartColors = {
    donut: {
      series1: '#24B364',
      
      series2: '#A9E9C5'
    }
  };
  const generatedLeadsChartEl = document.querySelector('#generatedLeadsChart'),
    generatedLeadsChartConfig = {
      chart: {
        height: 125,
        width: 120,
        parentHeightOffset: 0,
        type: 'donut'
      },
      labels: ['Occupied', 'Advertised'],
      series: {{occupied_vs_advertised}},
      colors: [
        chartColors.donut.series1,
        chartColors.donut.series2,
        chartColors.donut.series3,
        chartColors.donut.series4
      ],
      stroke: {
        width: 0
      },
      dataLabels: {
        enabled: false,
        formatter: function (val, opt) {
          return parseInt(val) + '%';
        }
      },
      legend: {
        show: false
      },
      tooltip: {
        theme: false
      },
      grid: {
        padding: {
          top: 15,
          right: -20,
          left: -20
        }
      },
      states: {
        hover: {
          filter: {
            type: 'none'
          }
        }
      },
      plotOptions: {
        pie: {
          donut: {
            size: '70%',
            labels: {
              show: true,
              value: {
                fontSize: '1.5rem',
                fontFamily: 'fontFamily',
                color: headingColor,
                fontWeight: 500,
                offsetY: -15,
                formatter: function (val) {
                  return parseInt(val) + '%';
                }
              },
              name: {
                offsetY: 20,
                fontFamily: 'fontFamily'
              },
              total: {
                show: true,
                showAlways: true,
                color: config.colors.success,
                fontSize: '.8125rem',
                label: 'Total',
                fontFamily: 'fontFamily',
                formatter: function (w) {
                  return '{{total_room}}';
                }
              }
            }
          }
        }
      },
      responsive: [
        {
          breakpoint: 1025,
          options: {
            chart: {
              height: 172,
              width: 160
            }
          }
        },
        {
          breakpoint: 769,
          options: {
            chart: {
              height: 178
            }
          }
        },
        {
          breakpoint: 426,
          options: {
            chart: {
              height: 147
            }
          }
        }
      ]
    };
  if (typeof generatedLeadsChartEl !== undefined && generatedLeadsChartEl !== null) {
    const generatedLeadsChart = new ApexCharts(generatedLeadsChartEl, generatedLeadsChartConfig);
    generatedLeadsChart.render();
  }
    function deactivate(id,name) {
    var id =id
    var approveLandloadUrl='/landload/deactivate_property/'+id
  Swal.fire({

      title: "Are you sure?",
      text: "You want to approve "+name,
      icon: "warning",
      showCancelButton: true,
      confirmButtonColor: "#3085d6",
      cancelButtonColor: "#d33",
      confirmButtonText: "Approved"
    }).then((result) => {
      if (result.isConfirmed) {
        var pk=id
        // If user confirms, make AJAX request to delete endpoint
        // Replace 'delete-url' with the actual URL to delete the item
        fetch(approveLandloadUrl, {  // Use template literal
          method: 'get',
          headers: {
            'Content-Type': 'application/json'
          }
        })
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.json();
        })
        .then(data => {
          // Handle success response
          Swal.fire({
            title: "Approved!",
            text: "Landload has been Approved.",
            icon: "success"
          }).then(() => {
                    // Reload the page after showing the alert
                    location.reload();
                });
        })
        .catch(error => {
          // Handle error
          console.error('Error Approved Landload:', error);
          Swal.fire({
            title: "Error",
            text: "Failed to Approved the Landload.",
            icon: "error"
          });
        });
      }
    });
}

function rejected_landload(id,name) {
    var id =id
    var rejectedLandloadUrl='/landload/reject_landload/'+id
  Swal.fire({

      title: "Are you sure?",
      text: "You want to reject "+name,
      icon: "warning",
      showCancelButton: true,
      confirmButtonColor: "#3085d6",
      cancelButtonColor: "#d33",
      confirmButtonText: "rejected"
    }).then((result) => {
      if (result.isConfirmed) {
        var pk=id
        // If user confirms, make AJAX request to delete endpoint
        // Replace 'delete-url' with the actual URL to delete the item
        fetch(rejectedLandloadUrl, {  // Use template literal
          method: 'get',
          headers: {
            'Content-Type': 'application/json'
          }
        })
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.json();
        })
        .then(data => {
          // Handle success response
          Swal.fire({
            title: "rejected!",
            text: "Landload has been rejected.",
            icon: "success"
          }).then(() => {
                    // Reload the page after showing the alert
                    location.reload();
                });
        })
        .catch(error => {
          // Handle error
          console.error('Error rejected Landload:', error);
          Swal.fire({
            title: "Error",
            text: "Failed to rejected the Landload.",
            icon: "error"
          });
        });
      }
    });
}

    /*=========================================================================================
    File Name: app-user-list.js
    Description: User List page
    --------------------------------------------------------------------------------------
    Item Name: Vuexy  - Vuejs, HTML & Laravel Admin Dashboard Template
    Author: PIXINVENT
    Author URL: http://www.themeforest.net/user/pixinvent

==========================================================================================*/
$(function () {
  ('use strict');

  var dtUserTable = $('.user-list-table'),
    newUserSidebar = $('.new-user-modal'),
    newUserForm = $('.add-new-user'),
    select = $('.select2'),
    dtContact = $('.dt-contact'),
    statusObj = {
      1: { title: 'Pending', class: 'badge-light-warning' },
      2: { title: 'Active', class: 'badge-light-success' },
      3: { title: 'Inactive', class: 'badge-light-secondary' }
    };

  var assetPath = "{% static 'app-assets/' %}",
    userView = 'app-user-view-account.html';

  if ($('body').attr('data-framework') === 'laravel') {
    assetPath = $('body').attr('data-asset-path');
    userView = assetPath + 'app/user/view/account';
  }

  select.each(function () {
    var $this = $(this);
    $this.wrap('<div class="position-relative"></div>');
    $this.select2({
      // the following code is used to disable x-scrollbar when click in select input and
      // take 100% width in responsive also
      dropdownAutoWidth: true,
      width: '100%',
      dropdownParent: $this.parent()
    });
  });

  // Users List datatable
  
  // Form Validation
  if (newUserForm.length) {
    newUserForm.validate({
      errorClass: 'error',
      rules: {
        'user-fullname': {
          required: true
        },
        'user-name': {
          required: true
        },
        'user-email': {
          required: true
        }
      }
    });

    newUserForm.on('submit', function (e) {
      var isValid = newUserForm.valid();
      e.preventDefault();
      if (isValid) {
        newUserSidebar.modal('hide');
      }
    });
  }

  // Phone Number
  if (dtContact.length) {
    dtContact.each(function () {
      new Cleave($(this), {
        phone: true,
        phoneRegionCode: 'US'
      });
    });
  }
});
</script>



{% endblock scriptjs %}
</html>